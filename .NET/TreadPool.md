# Thread Pool
ThreadPool - это класс .NET, который используется для управления пулом рабочих потоков. Он позволяет разработчикам ставить в очередь рабочие элементы, которые затем выполняются потоками в пуле. ThreadPool автоматически управляет созданием и уничтожением потоков, а также предоставляет механизмы для управления количеством потоков и их приоритетами. Он разработан, чтобы быть эффективным и минимизировать накладные расходы на создание и управление потоками. В .NET 5 ThreadPool используется для одновременной обработки нескольких запросов, что повышает производительность приложения.

Вот несколько примеров того, как вы можете использовать ThreadPool в .NET:
1. Выполнение задачи асинхронно:
```cs
ThreadPool.QueueUserWorkItem(new WaitCallback(MyTask), parameter);
```
В этом примере "MyTask" - это метод, который принимает один параметр объекта, а "parameter" - это объект, передаваемый методу. ThreadPool назначит поток из пула для выполнения метода. Это позволяет выполнять задачу асинхронно, без необходимости создавать и управлять собственным потоком.
2. Выполнение задания с тайм-аутом:
```cs
ThreadPool.RegisterWaitForSingleObject(
    myEvent, 
    new WaitOrTimerCallback(MyTask), 
    parameter, 
    1000, 
    true
);
```
В этом примере "MyTask" снова является методом, который принимает один параметр объекта, а "parameter" - это объект, который передается методу. ThreadPool назначит поток из пула для ожидания сигнала о событии "myEvent". Если сигнал о событии поступит в течение 1000 миллисекунд, поток выполнит метод "MyTask". Если в течение 1000 миллисекунд сигнал о событии не поступил, поток не будет выполнять метод. Это позволяет выполнять задачу с таймаутом, не создавая и не управляя собственным потоком.

Обратите внимание, что в обоих этих примерах ThreadPool автоматически управляет созданием и уничтожением потоков, что может значительно упростить ваш код и повысить производительность.

Вы также можете установить количество рабочих потоков и потоков порта завершения в ThreadPool, вызвав ThreadPool.SetMinThreads(workerThreads, completionPortThreads) и ThreadPool.SetMaxThreads(workerThreads, completionPortThreads). По умолчанию количество рабочих потоков зависит от количества процессоров, а количество потоков порта завершения - от количества процессоров, умноженного на 2.

Переведено с помощью www.DeepL.com/Translator (бесплатная версия)
