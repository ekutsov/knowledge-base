# Boxing and unboxing
**Boxing** и **Unboxing** - это понятия в C#, которые относятся к процессу преобразования типа значения в ссылочный тип (boxing) и наоборот (unboxing).

Boxing необходим, поскольку типы значений, такие как целые числа и булевы, хранятся на стеке, а ссылочные типы, такие как объекты, хранятся на куче. В некоторых случаях, например, когда тип значения должен быть передан в качестве параметра методу, принимающему тип ссылки, боксирование необходимо для преобразования типа значения в тип ссылки, чтобы его можно было передать.

Вот пример boxing в C#:

```cs
int i = 5;
object o = i; // здесь происходит boxing
```
Unboxing - это обратный процесс преобразования ссылочного типа обратно в тип значения. Он необходим, когда тип значения нужно извлечь из ссылочного типа.

Приведем пример unboxing в C#:

```cs
object o = 5;
int i = (int)o; // здесь происходит unboxing
```
Необходимо использовать boxing и unboxing при работе с коллекциями, такими как ``ArrayList``, которые хранят объекты, и вы хотите хранить типы значений, такие как ``int``, ``float``, ``bool`` и т.д.

```cs
ArrayList list = new ArrayList();
list.Add(5); // здесь происходит boxing
int i = (int)list[0]; // здесь происходит unboxing
```
В этих примерах значение ``int`` преобразуется в объект, чтобы его можно было добавить в список ``ArrayList``, а затем разворачивается обратно в ``int``, чтобы его можно было снова использовать как значение ``int``.

Боксинг и дебоксинг могут вызвать некоторые проблемы с производительностью в программах на C#.

Одной из основных проблем являются накладные расходы на процесс преобразования. **Boxing** и **unboxing** подразумевают создание новых объектов в куче, что может потребовать больших вычислительных затрат. Кроме того, при распаковке может потребоваться приведение типа, что может добавить дополнительные накладные расходы.

Другая проблема связана с использованием памяти, boxing создает новый объект на куче, это увеличивает использование памяти, а также создает дополнительную нагрузку на сборщик мусора.

Еще одной проблемой является потеря информации о типе при боксировании. Когда тип значения помещается в бокс, он становится объектом и теряет информацию о своем конкретном типе. Это может усложнить работу со значением и привести к неожиданному поведению.

И наконец, если вы работаете с большими коллекциями типов значений, постоянное боксирование и дебоксирование может существенно повлиять на производительность вашей программы, поэтому важно использовать коллекции с сильной типизацией, такие как ``List<int>`` или ``Dictionary<string,int>``, вместо коллекций негенеративного типа, таких как ``ArrayList`` или ``Hashtable``.

В целом, хотя **boxing** и **unboxing** могут быть полезны в определенных ситуациях, их следует использовать с осторожностью, чтобы избежать проблем с производительностью и неожиданного поведения.
